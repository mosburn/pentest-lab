#!/usr/bin/env bash

printf "Installing various items..."
sudo debconf-set-selections <<< 'mysql-server mysql-server/root_password password p@ssw0rd'
sudo debconf-set-selections <<< 'mysql-server mysql-server/root_password_again password p@ssw0rd'

sudo apt-get update >/dev/null 2>&1
sudo apt-get install -y curl default-jre default-jdk build-essential python2.7  python-dev python-pip ruby-full git lamp-server>/dev/null 2>&1
printf "Installing node.js and npm..."
curl -sL https://deb.nodesource.com/setup | sudo bash - >/dev/null 2>&1
sudo apt-get install -y nodejs >/dev/null 2>&1

printf "Creating symlink to /var/www..."
sudo rm -rf /var/www
sudo ln -fs /vagrant/DVWA /var/www

sudo a2enmod rewrite >/dev/null 2>&1
sudo sed -i '/AllowOverride None/c AllowOverride All' /etc/apache2/sites-available/default >/dev/null 2>&1
sudo service apache2 restart >/dev/null 2>&1
sudo service apache2 reload >/dev/null 2>&1